 
   portsentry - detect portscan activity

SYNOPSIS
       portsentry [ -tcp | -stcp | -atcp ]
       portsentry [ -udp | -sudp | -audp ]

DESCRIPTION
       This  manual  page documents briefly the portsentry command.  This manual page was written
       for the Debian GNU/Linux distribution because the original program does not have a  manual
       page.

       portsentry  is  a  program  that  tries to detect portscans on network interfaces with the
       ability to detect stealth scans. On alarm portsentry can block the  scanning  machine  via
       hosts.deny   (see   hosts_access(5),   firewall  rule  (see  ipfwadm(8),  ipchains(8)  and
       iptables(8)) or dropped route (see route(8)).

OPTIONS
       For details on the various modes see /usr/share/doc/portsentry/README.install

       -tcp   tcp portscan detection on ports  specified  under  TCP_PORTS  in  the  config  file
              /etc/portsentry/portsentry.conf.

       -stcp  As above but additionally detect stealth scans.

       -atcp  Advanced  tcp  or  inverse  mode.  Portsentry  binds  to  all  unused  ports  below
              ADVANCED_PORTS_TCP given in the config file /etc/portsentry/portsentry.conf.

       -udp   udp portscan detection on ports  specified  under  UDP_PORTS  in  the  config  file
              /etc/portsentry/portsentry.conf.

       -sudp  As above but additionally detect "stealth" scans.

       -audp  Advanced  udp  or  inverse  mode.  Portsentry  binds  to  all  unused  ports  below
              ADVANCED_PORTS_UDP given in the config file /etc/portsentry/portsentry.conf.

CONFIGURATION FILES
--------------------
       portsentry keeps all its  configuration  files  in  /etc/portsentry.   portsentry.conf  is
       portsentry's main configuration file. See portsentry.conf(5) for details.

       The  file portsentry.ignore contains a list of all hosts that are ignored, if they connect
       to a tripwired port. It should contain at least the localhost(127.0.0.1), 0.0.0.0 and  the
       IP addresses of all local interfaces. You can ignore whole subnets by using a notation <IP
       Address>/<Netmask Bits>. It is  *not* recommend  putting  in  every  machine  IP  on  your
       network.  It  may  be  important  for you to see who is connecting to you, even if it is a
       "friendly" machine. This can help you detect internal host compromises faster.

       If you use the /etc/init.d/portsentry script to start  the  daemon,  portsentry.ignore  is
       rebuild  on  each  start  of  the  daemon  using  portsentry.ignore.static  and all the IP
       addresses found on the machine via ifconfig.

       /etc/default/portsentry specifies in which protocol modes  portsentry  should  be  startet
       from /etc/init.d/portsentry There are currently two options:

       TCP_MODE=
              either tcp, stcp or atcp (see OPTIONS above).

       UDP_MODE=
              either udp, sudp or audp (see OPTIONS above).

       The   options   above  correspond  to  portsentry's  commandline  arguments.  For  example
       TCP_MODE="atcp" has the same effect as to start portsentry using portsentry  -atcp.   Only
       one mode per protocol can be started at a time (i.e. one tcp and one udp mode).

- FILES
       /etc/portsentry/portsentry.conf main configuration file

       /etc/portsentry/portsentry.ignore
              IP addresses to ignore

       /etc/portsentry/portsentry.ignore.static
              static IP addresses to ignore

       /etc/default/portsentry
              startup options

       /etc/init.d/portsentry
              script responsible for starting and stopping the daemon

       /var/lib/portsentry/portsentry.blocked.*
              blocked hosts(cleared upon reload)

       /var/lib/portsentry/portsentry.history
              history file

SEE ALSO
       portsentry.conf(5),  hosts_access(5), hosts_options(5), route(8), ipfwadm(8), ipchains(8),
       iptables(8), ifconfig(8)

       /usr/share/doc/portsentry/README.install

       
----------------------------------------------------------------------------------------------------------------------------------

portsentry configuration
------------------------

- sudo passwd root
    set password to root
- apt-get update
- apt-get install portsentry
    portsentry does not block default anything page wil show click on "ok"
- 

    go to this above file and search 
    "Block_UDP="0""   0's represent not blocking
    "Block_TCP="0""
    and turn it to 1
    "Block_UDP="1""   1's represent blocking
    "Block_TCP="1""
    
    now search "KILL_HOSTS_DENY="ALL:$TARGET$"" and uncomment it. 
    
    now save the file... and exit it
    
- nano /etc/portsentry/portsentry.ignore.static
    this is ignore file...
- nano /etc/default/portsentry
    go to the file and search 
    TCP_MODE="tcp"
    UDP_MODE="udp" 
    and change it to
    TCP_MODE="stcp"
    UDP_MODE="sudp"
    
    exit and save it

- /etc/init.d/portsentry restart  
    now restart it. you will get [ok] in output
- tail -f /var/log/syslog
    in which you will get the logs
    
- now install "nmap"
    apt-get install nmap -y

- and check local host with nmap
    nmap localhost
    
    it will give you the nmap scan report for localhost and will say that : itny no of port close ker dye hn.
    
    
    
- extra
    go to nano /etc/portsentry/portsentry.conf
    uncomment this
    KILL_ROUTE="/sbin/iptables -I INPUT -s $TARGET$ -j DROP"
    
    and go to this file nano /etc/portsentry/portsentry.ignore.static
    
    and gave ignore ip pool... of your network.. like 192.168.0.1/24

Portsentry is a software that detects and actively responds to port scanning in real time. It works on FreeBSD, OpenBSD and Linux and detects various types of scans like SYN, FIN, and NULL scans. When a scan is detected, Portsentry logs it, adds the attacker's IP to the hosts.deny file to block access, and can also block the attacker by adding a route to a "black hole." It is typically placed behind a firewall or to protect individual hosts.
